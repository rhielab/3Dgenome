## Figure1 Comparison of Hi-C and Micro-C data.
### 1A. Experimental methods of Hi-C and Micro-C. Unlike Hi-C that uses restriction enzyme, Micro-C uses MNase, allowing to fragment chromatin to mono, di-, and tri-nucleosomes. 

### 1B. Chromatin interaction heatmaps of Hi-C and Micro-C data near chr7p14 region.
We used cooltools (https://github.com/open2c/cooltools) to generate the interaction heatmap. Here we provide a python script ```cooltools_heatmap.py``` to run cooltools. The required input to generate this plot is ```.mcool``` file. Below is the example code:

To run the script, please make sure that you have installed cooltools correctly. 
- 1st - mcool file
- 2nd - output path
- 3rd - prefix for the output
```
python cooltools_heatmap.py \
input/uni1945_2.5kb_1_billion.filt.mcool \
output/ \
20kb_chr7_31M-43M_Micro_C_1_Bil
```

### 1C. Venn diagram of TADs identified from Hi-C and Micro-C.

The script ```topdom_comparison.R``` shows how we perform the overlap analysis using the TAD data generated from TopDom (Shin H et al, Nucleic Acids Res, 2016).  The inputs are the TAD bed files generated by TopDom and the script will output the shared TAD number.

To run TopDom, the required input is ```.hic``` file. Below is the example code we used:

First, generate sparse matrix format ending with bp.txt files using python script.

- The 1st input is the path to hic file.
- The 2nd input is the resolution, here we choose 50KB. Please specify this option according to your need.
- The 3rd input is the prefix for the output
```
python HiC_to_TopDom_format.py \
EXAMPLE.hic \
50000 \
2_Billion
```

And then generate topdom output
- The 1st input is the prefix
- The 2nd input is the resolution, here we choose 50KB. Please specify this option according to your need.
```
Rscript run_TopDom.R \
2_Billion \
50000
```

Combine topdom output and produce final output topdom bed file with domain information
```
tail -n +2 *topdom.bed | grep -v '==>' > 2_Billion-50000-topdom.bed
```
For more usage instruction for TopDom, please refer to github page: https://github.com/HenrikBengtsson/TopDom.

### 1D. Triangular heatmaps of Hi-C and Micro-C near chr1p32 region. TADs identified from each data are shown at the bottom.

### 1E. Average chromatin interaction signals at shared loops (loops found in Hi-C and Micro-C) and unique loops. 

The pileup plots are generated by cooltools (https://github.com/open2c/cooltools). 

Here we provide a python script ```cooltools_pileup.py``` to generate pileup plot using coolstools. The required input file format is ```.mcool```. Below is the example code:


To run ```cooltools_pileup.py```, cooltools conda environment is required
- 1st - mcool file
- 2nd - loop file 
- 3rd - output path
- 4th - output prefix
```
python cooltools_pileup.py \
uni1945_1kb_1_billion.filt.mcool \
1_Billion_Mustache-2kb-all-loop.bedpe \
./output \
Micro_C_2kb_Mustache_Loop
```
